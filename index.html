<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Bluetooth Auto-Connect PWA</title>
    <link rel="manifest" href="/manifest.json">
    <script>
        // Check if the browser supports Web Bluetooth
        if (!navigator.bluetooth) {
            alert('Web Bluetooth is not supported in this browser. Please use Chrome or Edge.');
        }

        async function scanAndConnect() {
            try {
                const device = await navigator.bluetooth.requestDevice({
                    acceptAllDevices: true,
                    optionalServices: ['device_information']
                });
                
                if (device.name === 'smart.robert') {
                    await connectToDevice(device);
                } else {
                    alert(`Found ${device.name}, but not smart.robert. Please try again.`);
                }
            } catch (error) {
                alert(`Error: ${error.message}`);
            }
        }

        async function connectToDevice(device) {
            try {
                const server = await device.gatt.connect();
                alert(`Connected to ${device.name}`);
            } catch (error) {
                alert(`Connection failed: ${error.message}`);
            }
        }

        // Automatically start scanning when the page loads
        window.onload = scanAndConnect;

        // Register service worker for PWA
        if ('serviceWorker' in navigator) {
            navigator.serviceWorker.register('/sw.js').then(() => {
                console.log('Service Worker Registered');
            });
        }
    </script>
</head>
<body>
    <h1>Bluetooth Auto-Connect PWA</h1>
    <p>Scanning for smart.robert...</p>
</body>
</html>
